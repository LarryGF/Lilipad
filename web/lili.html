<!DOCTYPE html>
<html>
	
	<head>
		<title>LiliPad</title>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="node_modules/vue-material/dist/vue-material.css">
		<link rel="stylesheet" href="node_modules/vue-material/dist/theme/default.css">
	</head>
	
	<body>
		<div id='app'>
			<script type='text/javascript' src='/eel.js'></script>
			<script type='text/javascript'>
				load_table(1,'')
				load_table(2,'tab_serv')
				load_table(2,'nuevos')
				load_table(2,'existentes')
				load_table(2,'futuros')
				
			async function load_table(step,table){
				switch (step) {
					case 1:
						let value = await eel.load(1, '')();
						app.actuales = value['usract'];
						app.nuevos = value['usrnew'];
						app.futuros = value['usrfutr'];
						break;
				}
					
				let value = await eel.load(step,table)();  
				// poner app.new_srv
				console.log(value)
				console.log(table)
				switch (table) {
					case 'tab_serv':
					console.log(table)
					app.tabla_servicios = value;
					break;

					case 'nuevos':
					console.log(table)
					app.serv_nuevos = value;
					break;

					case 'existentes':

					app.serv_existentes = value;
					break;

					case 'futuros':
					app.serv_futuros = value;
					break;
				}
				// break;
				
			}

		</script>

		<div>
			<md-tabs class="md-primary" md-alignment="centered" :md-active-tab.sync="step" >
			<md-tab id="paso1" md-label="Paso 1" >
				<md-field>
					<label>Usuarios actuales</label>
					<md-input v-model="actuales" type="number"></md-input>
				</md-field>

				<md-field>
					<label>Usuarios nuevos</label>
					<md-input v-model="nuevos" type="number"></md-input>
				</md-field>

				<md-field>
					<label>Usuarios futuros</label>
					<md-input v-model="futuros" type="number"></md-input>
				</md-field>

				<md-button class="md-raised md-primary" @click="send(1,{usract:actuales,usrnew:nuevos,usrfutr:futuros,})">Guardar</md-button>
			</md-tab>

			<md-tab id="paso2" md-label="Paso 2" >
				<div>
					<md-table @md-selected="onSelect" v-model="tabla_servicios" md-sort="name" md-sort-order="asc" md-card md-fixed-header>
						<md-table-toolbar>
							<h1 class="md-title">Servicios</h1>
							<md-button class="md-raised md-primary" @click="send(2,tabla_servicios)">Guardar</md-button>
				
							<md-button class="md-raised md-primary" @click="change('tab_serv')">Nuevo</md-button>
						</md-table-toolbar>
				
						<md-table-row md-selectable="multiple" md-auto-select slot="md-table-row" slot-scope="{ item }">
							<md-table-cell md-label="Servicio" md-sort-by="service" md-numeric>{{ item.service }}</md-table-cell>
							<md-table-cell md-label="Subservicio" md-sort-by="subservice">{{ item.subservice }}</md-table-cell>
							<md-table-cell md-label="Maquina Virtual" md-sort-by="vmachine">{{ item.vmachine }}</md-table-cell>
							<md-table-cell md-label="Nodo" md-sort-by="node">{{ item.node }}</md-table-cell>
						</md-table-row>
					</md-table>
				</div>
				<div>
					<md-table @md-selected="onSelect" v-model="serv_existentes" md-sort="name" md-sort-order="asc" md-card md-fixed-header>
						<md-table-toolbar>
							<h1 class="md-title">Servicios Existentes</h1>
							<md-button class="md-raised md-primary" @click="send(2,serv_existentes)">Guardar</md-button>
							
							<md-button class="md-raised md-primary" @click="change('existentes')">Nuevo</md-button>
						</md-table-toolbar>

						<md-table-row md-selectable="multiple" md-auto-select slot="md-table-row" slot-scope="{ item }">
							<md-table-cell md-label="Nombre" md-sort-by="name" md-numeric>{{ item.name }}</md-table-cell>
							<md-table-cell md-label="Tipo" md-sort-by="type">{{ item.type }}</md-table-cell>
							<md-table-cell md-label="Clasificacion" md-sort-by="class">{{ item.class }}</md-table-cell>
							<md-table-cell md-label="Estructura" md-sort-by="structure">{{ item.structure }}</md-table-cell>
							<md-table-cell md-label="Criticidad" md-sort-by="int">{{ item.criticity }}</md-table-cell>
							<md-table-cell md-label="Comentarios" md-sort-by="comments">{{ item.comments }}</md-table-cell>							
						</md-table-row>
					</md-table>
				</div>
				
				<div>
					<md-table @md-selected="onSelect" v-model="serv_nuevos" md-sort="name" md-sort-order="asc" md-card md-fixed-header>
						<md-table-toolbar>
							<h1 class="md-title">Servicios Nuevos</h1> 
							<md-button class="md-raised md-primary" @click="send(2,serv_nuevos)">Guardar</md-button>						
							<md-button class="md-raised md-primary"  @click="change('nuevos')">Nuevo</md-button>
						</md-table-toolbar>

					<md-table-row md-selectable="multiple" md-auto-select slot="md-table-row" slot-scope="{ item }">
						<md-table-cell md-label="Nombre" md-sort-by="name" md-numeric>{{ item.name }}</md-table-cell>
						<md-table-cell md-label="Tipo" md-sort-by="type">{{ item.type }}</md-table-cell>
						<md-table-cell md-label="Clasificacion" md-sort-by="class">{{ item.class }}</md-table-cell>
						<md-table-cell md-label="Estructura" md-sort-by="structure">{{ item.structure }}</md-table-cell>
						<md-table-cell md-label="Criticidad" md-sort-by="int">{{ item.criticity }}</md-table-cell>
						<md-table-cell md-label="Comentarios" md-sort-by="comments">{{ item.comments }}</md-table-cell>
					</md-table-row>

					</md-table>
				</div>
				
				<div>
					<md-table @md-selected="onSelect" v-model="serv_futuros" md-sort="name" md-sort-order="asc" md-card md-fixed-header>
						<md-table-toolbar>
							<h1 class="md-title">Servicios Futuros</h1>
							<md-button class="md-raised md-primary" @click="send(2,serv_futuros)">Guardar</md-button>
							<md-button class="md-raised md-primary"  @click="change('futuros')">Nuevo</md-button>		
						</md-table-toolbar>

					<md-table-row md-selectable="multiple" md-auto-select slot="md-table-row" slot-scope="{ item }">
						<md-table-cell md-label="Nombre" md-sort-by="name" md-numeric>{{ item.name }}</md-table-cell>
						<md-table-cell md-label="Tipo" md-sort-by="type">{{ item.type }}</md-table-cell>
						<md-table-cell md-label="Clasificacion" md-sort-by="class">{{ item.class }}</md-table-cell>
						<md-table-cell md-label="Estructura" md-sort-by="structure">{{ item.structure }}</md-table-cell>
						<md-table-cell md-label="Criticidad" md-sort-by="int">{{ item.criticity }}</md-table-cell>
						<md-table-cell md-label="Comentarios" md-sort-by="comments">{{ item.comments }}</md-table-cell>
					</md-table-row>
					
					</md-table>
				</div>
			</md-tab>

			<md-tab id="paso3" md-label="Paso 3" >
				<div v-if='!selection'>
					<h2>Seleccione una o ambas opciones</h2>
				<div>
					<md-checkbox v-model="iaas" class="md-primary">IaaS</md-checkbox>
					<md-checkbox v-model="dsaas" class="md-primary">DaaS</md-checkbox>
				</div>

				<md-button class="md-raised md-primary" @click="selection=true">Aceptar</md-button>

				</div>

				<div v-if='selection & iaas'>Aqui va la tabla IaaS</div>
				<div v-if='selection & dsaas'>Aqui va la tabla DSaaS</div>
			</md-tab>

			<md-tab id="paso4" md-label="Paso 4" >

			</md-tab>

			<md-tab id="paso5" md-label="Paso 5" >

			</md-tab>

		</md-tabs>

		<script src="node_modules/vue/dist/vue.min.js"></script>
		<script src="node_modules/vue-material/dist/vue-material.js"></script>

		<md-dialog :md-active.sync="add_srv" :md-click-outside-to-close="false">
			<div v-if="new_srv != 'tab_serv'">
			<md-tabs md-dynamic-height class="md-primary">
				<md-tab md-label="Nuevo Servicio">
					<md-field>
						<label>Nombre</label>
						<md-input v-model="srv_name" required></md-input>
					</md-field>

					<md-field>
						<label>Tipo</label>
						<md-input v-model="srv_type" required></md-input>
					</md-field>

					<select v-model="srv_class" >
						<option disabled value="">Clasificacion</option>
						<option value="Usuario">Usuario</option>
						<option value="Soporte">Soporte</option>
					</select>

					<select v-model="srv_structure" >
						<option disabled value="">Estructura</option>
						<option value="Single Tier">Single Tier</option>
						<option value="Multi Tier">Multi Tier</option>
					</select>

					<select v-model="srv_criticity" >
						<option disabled value="">Criticidad</option>
						<option  value="Baja">Baja</option>
						<option  value="Media">Media</option>
						<option  value="Alta">Alta</option>
					</select>

					<md-field>
						<label>Comentarios</label>
						<md-input v-model="srv_comments" required></md-input>
					</md-field>

				</md-tab>
			</md-tabs>

			<md-dialog-actions>
				<md-button class="md-primary" @click="new_service(new_srv,{'name':srv_name,'type':srv_type,'class':srv_class,'structure':srv_structure,'criticity':srv_criticity,'comments':srv_comments,'int':srv_criticity[0]})">Crear</md-button>
			</md-dialog-actions>
			
			
		</div>
		<div v-if="new_srv == 'tab_serv'">
			<md-tabs md-dynamic-height class="md-primary">
				<md-tab md-label="Agregar a tabla de servicios">
					<md-field>
						<label>Servicio</label>
						<md-input v-model="tab_service" required></md-input>
					</md-field>
		
					<md-field>
						<label>Subservicio</label>
						<md-input v-model="tab_subservice" required></md-input>
					</md-field>
		
					<md-field>
						<label>Maquina Virtual</label>
						<md-input v-model="tab_vm" required></md-input>
					</md-field>
					
					<md-field>
						<label>Nodo</label>
						<md-input v-model="tab_node" required></md-input>
					</md-field>
				</md-tab>
			</md-tabs>
		
			<md-dialog-actions>
				<md-button class="md-primary" @click="new_service(new_srv,{'service':tab_service,'subservice':tab_subservice,'vmachine':tab_vm,'node':tab_node})">Crear</md-button>
			</md-dialog-actions>
		
		</div>
				<md-dialog-actions>
					<md-button class="md-primary" @click="add_srv=false,srv_class='',srv_comments=null,srv_criticity='',srv_name=null,srv_structure='',srv_type=null,tab_service='',tab_subservice='',tab_vm='',tab_node=''">Cerrar</md-button>
				</md-dialog-actions>
		</md-dialog>


		<script>Vue.use(VueMaterial.default)

		const app = new Vue({
			el: "#app",
			data: {
				selection:false,
				selected:[],
				iaas:false,
				dsaas:false,
				new_srv:'',
				add_srv:false,
				step:'paso1',
				actuales:'',
				nuevos:'',
				futuros:'',
				srv_name:'',
				srv_type:'',
				srv_class:'',
				srv_structure:'',
				srv_criticity:'',
				srv_comments:'',
				tab_service:'',
				tab_subservice:'',
				tab_vm:'',
				tab_node:'',

				tabla_servicios:[
					// {service: 'Navegacion',
					//  subservice: 'Proxy',
					//  vmachine: 'Jango',
					//  node: 'Palpatine'	
					// },
					// {
					// 	service: 'Navegacion',
					// 	subservice: 'DNS',
					// 	vmachine: 'Jango',
					// 	node: 'Palpatine'
					// },
				],
				serv_existentes: [
					// {
					// name: 'Zabbix',
					// type: 'inutil',
					// class: 'Soporte',
					// structure: 'Single Tier',
					// criticity:'Baja',
					// int:'0',
					// comments:'No le importa a nadie',
					// },
					// {
					// name: 'Navegacion',
					// type: 'Squid',
					// class: 'Soporte',
					// structure: 'Multi Tier',
					// criticity: 'Alta',
					// int:'2',
					// comments: 'Sin esto la gente se suicida',
					// },
					// {
					// name: 'Navegacion',
					// type: 'DNS',
					// class: 'Soporte',
					// structure: 'Multi Tier',
					// criticity: 'Media',
					// int:'1',
					// comments: 'Sin esto la gente no puede ir a facebook',
					// },
				],

				serv_nuevos: [
					// {
					// name: 'Zabbix1',
					// type: 'inutil',
					// class: 'Soporte',
					// structure: 'Single Tier',
					// criticity: 'Baja',
					// int: '0',
					// comments: 'No le importa a nadie',
					// },
					// {
					// name: 'Navegacion',
					// type: 'Squid',
					// class: 'Soporte',
					// structure: 'Multi Tier',
					// criticity: 'Alta',
					// int: '2',
					// comments: 'Sin esto la gente se suicida',
					// },
					// {
					// name: 'Navegacion',
					// type: 'DNS',
					// class: 'Soporte',
					// structure: 'Multi Tier',
					// criticity: 'Media',
					// int: '1',
					// comments: 'Sin esto la gente no puede ir a facebook',
					// },
				],
				serv_futuros: [
					// {
					// name: 'Zabbix2',
					// type: 'inutil',
					// class: 'Soporte',
					// structure: 'Single Tier',
					// criticity: 'Baja',
					// int: '0',
					// comments: 'No le importa a nadie',
					// },
					// {
					// name: 'Navegacion',
					// type: 'Squid',
					// class: 'Soporte',
					// structure: 'Multi Tier',
					// criticity: 'Alta',
					// int: '2',
					// comments: 'Sin esto la gente se suicida',
					// },
					// {
					// name: 'Navegacion',
					// type: 'DNS',
					// class: 'Soporte',
					// structure: 'Multi Tier',
					// criticity: 'Media',
					// int: '1',
					// comments: 'Sin esto la gente no puede ir a facebook',
					// },
				],


			},
			computed: {

			},
			methods: {
				send(paso,dict){
					// console.log(paso)
					// console.log(app.new_srv)
					// console.log(dict)
					
					let result = eel.handler(paso,app.new_srv,dict)()
					console.log(result)
					if (paso == 1) {
						paso = paso + 1
						app.step = "paso" + paso
						console.log(app.step)
					}
				},
				change(serv){
					app.add_srv=true
					app.new_srv=serv
				},

				new_service(service,dict){
					console.log(app.new_srv)
					console.log(dict)
					switch (service){
						case 'existentes':
							app.serv_existentes.push(dict);
							break;
						
						case 'nuevos':
							app.serv_nuevos.push(dict);
							break;
						
						case 'futuros':
							app.serv_futuros.push(dict);
							break;
							
						case 'tab_serv':
							app.tabla_servicios.push(dict)

					}
					console.log(app.serv_existentes)
					app.srv_name= '',
					app.srv_type= '',
					app.srv_class= '',
					app.srv_structure= '',
					app.srv_criticity= '',
					app.srv_comments= '',
					app.tab_service='',
					app.tab_subservice='',
					app.tab_vm='',
					app.tab_node=''

				},
				onSelect(items) {
					this.selected = items
				},

				
			}
		})
		</script>
	</div>



</body>            